#/usr/bin/env python3
from chromadb import PersistentClient

class ChromaStore:
    def __init__(self, path: str, collection: str):
        self.client = PersistentClient(path=path)
        self.col = self.client.get_or_create_collection(collection)

    def upsert(self, ids, embeddings, metadatas, documents):
        self.col.upsert(ids=ids, embeddings=embeddings,
                        metadatas=metadatas, documents=documents)

    def query(self, embedding, k=8, where=None):
        if where is None:
            return self.col.query(query_embeddings=[embedding], n_results=k)
        return self.col.query(query_embeddings=[embedding], n_results=k, where=where)
